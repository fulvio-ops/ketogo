---
const { post } = Astro.props;

function timeAgo(utc) {
  const diff = Math.max(1, Math.floor(Date.now()/1000 - utc));
  const h = Math.floor(diff / 3600);
  if (h < 24) return `${h}h ago`;
  const d = Math.floor(h / 24);
  return `${d}d ago`;
}
---
<a
  href={post.url}
  target="_blank"
  rel="noreferrer"
  class="block mx-4 rounded-3xl border border-[rgb(var(--stroke))] bg-[rgb(var(--card))]
         overflow-hidden transition-transform active:scale-[0.99]"
>
  {post.thumb && (
    <div class="relative">
      <img src={post.thumb} alt="" class="w-full h-56 object-cover" loading="lazy" />
      <div class="absolute inset-0 bg-gradient-to-t from-black/55 via-black/0 to-black/0"></div>
      <div class="absolute bottom-4 left-4 right-4">
        <div class="inline-flex items-center gap-2 text-[11px] uppercase tracking-[0.22em] text-white/80">
          <span class="h-1.5 w-1.5 rounded-full bg-[rgb(var(--accent))]"></span>
          <span>Hero</span>
        </div>
      </div>
    </div>
  )}

  <div class="px-5 pt-5 pb-6">
    <h2 class="font-display text-[28px] leading-[1.05] tracking-tight">
      {post.title}
    </h2>

    <div class="mt-5 flex flex-wrap items-center gap-x-3 gap-y-2 text-[12px] text-[rgb(var(--muted))]">
      <span class="inline-flex items-center gap-2">
        <span class="h-px w-8 bg-[rgb(var(--stroke))]"></span>
        r/{post.subreddit}
      </span>
      <span>·</span>
      <span>{timeAgo(post.createdUtc)}</span>
      {post.domain && (<>
        <span>·</span><span>{post.domain}</span>
      </>)}
    </div>

    <div class="mt-4 h-px w-full bg-[rgb(var(--stroke))]"></div>

    <div class="mt-3 flex items-center justify-between text-[11px] text-[rgb(var(--muted))]">
      <span>Source: Reddit</span>
      <span class="text-[rgb(var(--accent))]">Open →</span>
    </div>
  </div>
</a>
