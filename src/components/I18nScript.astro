---
import strings from "../i18n/strings.json";
const defaultLang = "en";
---
<script>
  const STRINGS = {"en": {"brand": "KETOGO", "tagline": "Weekly visual selection", "scroll": "Scroll to enter.", "articles": "Articles", "oddities": "Bizarre stuff for sale", "language": "Language", "issue": "Issue", "generated": "Generated"}, "it": {"brand": "KETOGO", "tagline": "Selezione visiva settimanale", "scroll": "Scorri per entrare.", "articles": "Articoli", "oddities": "Cose bizzarre in vendita", "language": "Lingua", "issue": "Uscita", "generated": "Generato"}};
  const KEY = "ketogo_lang";
  const supported = new Set(["en","it"]);
  function infer(){
    const nav = (navigator.language || "en").slice(0,2).toLowerCase();
    return supported.has(nav) ? nav : "en";
  }
  function get(){ return localStorage.getItem(KEY) || infer(); }
  function apply(lang){ 
    document.documentElement.dataset.lang = lang;
    const dict = STRINGS[lang] || STRINGS["en"];
    document.querySelectorAll("[data-i18n]").forEach(el => {
      const k = el.getAttribute("data-i18n");
      if(dict && dict[k]) el.textContent = dict[k];
    });
    document.querySelectorAll("[data-judgment-en]").forEach(el => el.classList.toggle("hidden", lang==="it"));
    document.querySelectorAll("[data-judgment-it]").forEach(el => el.classList.toggle("hidden", lang!=="it"));
  }
  function set(lang){ if(!supported.has(lang)) return; localStorage.setItem(KEY, lang); apply(lang); }
  window.ketogo = window.ketogo || {};
  window.ketogo.setLang = set;
  window.ketogo.getLang = get;
  window.addEventListener("DOMContentLoaded", () => apply(get()));
</script>
